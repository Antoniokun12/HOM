<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="form.css">
    <title>Formulario Registro</title>
</head>

<body>
    <section class="register" id="register">
        <form id="miFormulario">
            <h4>Formulario Registro</h4>
            <h3 id="alert" class="alert"></h3>
            <input class="controls" type="text" name="nombres" id="nombres" placeholder="Ingrese su Nombre" required>
            <input class="controls" type="text" name="apellidos" id="apellidos" placeholder="Ingrese su Apellido"
                required>
            <input class="controls" type="email" name="correo" id="correo" placeholder="Ingrese su Correo" required>
            <div class="genero" id="generoo">
                <label class="desplegable" for="genero">GENERO</label>
                <select class="gen-select" name="genero" id="genero">
                    <option value="man">Hombre</option>
                    <option value="women">Mujer</option>
                </select>
            </div>
            <div class="documento" id="Documentoo">
                <label class="desplegable" for="Document">Tipo de Documento</label>
                <select class="ge-select" name="Documento" id="Documento">
                    <option value="CC">CC</option>
                    <option value="CE">CE</option>
                    <option value="TI">TI</option>
                </select>
            </div>
            <input class="controls" type="text" name="documento" id="documento" placeholder="Ingrese su Documento"
                required>
            <input class="controls" type="text" name="Telefono" id="Telefono" placeholder="Telefono" required>
            <input class="controls" type="date" name="date" id="date" placeholder="Fecha de nacimiento" required>
            <button class="Registrar" type="button" onclick="validar()">Registrar</button>
        </form>
    </section>
    <table>
        <thead>
            <tr>
                <td>Nombre</td>
                <td>Apellido</td>
                <td>Correo</td>
                <td>Genero</td>
                <td>Tipo de Documento</td>
                <td>Numero de Documento</td>
                <td>Telefono</td>
                <td>Fecha de Nacimiento</td>
                <td>Opcion</td>
            </tr>
        </thead>
        <tbody id="tabla">

        </tbody>
    </table>
    <script>
        let Datos = []
        let op = null
        let indice = null
        function Registrar() {
            let nombre = document.getElementById("nombres").value;
            let apellido = document.getElementById("apellidos").value;
            let correo = document.getElementById("correo").value;
            let genero = document.getElementById("genero").value;
            let tipoDocumento = document.getElementById("Documento").value;
            let numeroDocumento = document.getElementById("documento").value;
            let telefono = document.getElementById("Telefono").value;
            let fechaNacimiento = document.getElementById("date").value;

            if (op === true) {
                Datos[indice].nombre = document.getElementById("nombres").value
                Datos[indice].apellido = document.getElementById("apellidos").value
                Datos[indice].correo = document.getElementById("correo").value
                Datos[indice].genero = document.getElementById("genero").value
                Datos[indice].tipoDocumento = document.getElementById("Documento").value
                Datos[indice].numeroDocumento = document.getElementById("documento").value
                Datos[indice].telefono = document.getElementById("Telefono").value
                Datos[indice].fechaNacimiento = document.getElementById("date").value
            } else {
                Datos.push({
                    nombre: nombre,
                    apellido: apellido,
                    correo: correo,
                    genero: genero,
                    tipoDocumento: tipoDocumento,
                    numeroDocumento: numeroDocumento,
                    telefono: telefono,
                    fechaNacimiento: fechaNacimiento,
                })
            }
            // alert("Su informacion fue registrada");
            console.log(Datos);
            document.getElementById("tabla").innerHTML = ""
            pintar();
            Limpiar();
            op = false
        }

        function validar() {
            const correo = document.getElementById("correo").value;
            const rule = new RegExp("[a-z0-9._%+-]+@[a-z0-9.-]+\.com$");
            const docu = document.getElementById("documento").value;
            const Tele = document.getElementById("Telefono").value;
            if (document.getElementById("nombres").value == "") {
                document.getElementById("alert").textContent = "Por favor el nombre esta vacio"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (document.getElementById("apellidos").value == "") {
                document.getElementById("alert").textContent = "Por favor el apellido esta vacio"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (document.getElementById("correo").value == "") {
                document.getElementById("alert").textContent = "Por favor el correo esta vacio"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (!correo.includes("@")) {
                document.getElementById("alert").textContent = "El correo debe contener un @"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (!rule.test(correo)) {
                document.getElementById("alert").textContent = "Por favor ingrese correo valido (correo@dominio.com)"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (!genero) {
                document.getElementById("alert").textContent = "Por favor escoja un genero valido"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (!Documento) {
                document.getElementById("alert").textContent = "Por favor escoja un tipo de documento valido"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (document.getElementById("documento").value == "") {
                document.getElementById("alert").textContent = "Por favor el numero de documento esta vacio"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (/[^\d]/.test(docu)) {
                document.getElementById("alert").textContent = "Por favor ingrese un numero de documento valido"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (document.getElementById("Telefono").value == "") {
                document.getElementById("alert").textContent = "Por favor el numero de telefono esta vacio"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (/[^\d]/.test(Tele)) {
                document.getElementById("alert").textContent = "Por favor ingrese un numero de telefono valido"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else if (document.getElementById("date").value == "") {
                document.getElementById("alert").textContent = "Por favor la fecha esta vacia"
                setTimeout(() => {
                    document.getElementById("alert").textContent = ""
                }, 3000);
            } else Registrar();
        }
        function pintar() {
            let frag = document.createDocumentFragment()

            Datos.forEach((item, index) => {
                let tr = document.createElement("tr")
                let td1 = document.createElement("td")
                let td2 = document.createElement("td")
                let td3 = document.createElement("td")
                let td4 = document.createElement("td")
                let td5 = document.createElement("td")
                let td6 = document.createElement("td")
                let td7 = document.createElement("td")
                let td8 = document.createElement("td")
                let td9 = document.createElement("td")
                let editar = document.createElement("button")
                let eliminar = document.createElement("button")
                editar.textContent = "📝"
                editar.addEventListener("click", () => {
                    edita(item, index)
                })
                eliminar.textContent = "❌"
                eliminar.addEventListener("click", () => {
                    borrar(index)
                })
                td1.textContent = item.nombre
                td2.textContent = item.apellido
                td3.textContent = item.correo
                td4.textContent = item.genero
                td5.textContent = item.tipoDocumento
                td6.textContent = item.numeroDocumento
                td7.textContent = item.telefono
                td8.textContent = item.fechaNacimiento
                td9.appendChild(editar)
                td9.appendChild(eliminar)
                tr.appendChild(td1)
                tr.appendChild(td2)
                tr.appendChild(td3)
                tr.appendChild(td4)
                tr.appendChild(td5)
                tr.appendChild(td6)
                tr.appendChild(td7)
                tr.appendChild(td8)
                tr.appendChild(td9)
                frag.appendChild(tr)
                document.getElementById("tabla").appendChild(frag)

            })
        }
        function Limpiar() {
            document.getElementById("nombres").value = "";
            document.getElementById("apellidos").value = "";
            document.getElementById("correo").value = "";
            document.getElementById("genero").value = "man";
            document.getElementById("Documento").value = "CC";
            document.getElementById("documento").value = "";
            document.getElementById("Telefono").value = "";
            document.getElementById("date").value = "";
        }
        function edita(r, i) {
            op = true
            indice = i
            console.log(r);
            document.getElementById("nombres").value = r.nombre
            document.getElementById("apellidos").value = r.apellido
            document.getElementById("correo").value = r.correo
            document.getElementById("genero").value = r.genero
            document.getElementById("Documento").value = r.tipoDocumento
            document.getElementById("documento").value = r.numeroDocumento
            document.getElementById("Telefono").value = r.telefono
            document.getElementById("date").value = r.fechaNacimiento
        }
        function borrar(i) {
            index = i
            Datos.splice(index, 1);
            document.getElementById("tabla").innerHTML = "";
            pintar();
        }
    </script>
</body>

</html>